<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>–ê—Ä–∫–∞–Ω–æ–∏–¥ - PERVUSHIN.EVENT</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }
    
    html, body {
      height: 100%;
      overflow: hidden;
      background: #000000;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      color: #ffd700;
      touch-action: manipulation;
    }
    
    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 10px;
      background: radial-gradient(circle at center, #1a1a1a 0%, #000000 100%);
    }
    
    .game-container {
      position: relative;
      width: 100%;
      max-width: 500px;
      margin: 0 auto;
    }
    
    .game-header {
      text-align: center;
      margin-bottom: 10px;
      width: 100%;
    }
    
    .game-title {
      font-size: 1.8rem;
      margin-bottom: 8px;
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
      font-weight: bold;
      letter-spacing: 1px;
    }
    
    .game-stats {
      display: flex;
      justify-content: space-between;
      width: 100%;
      background: rgba(0, 0, 0, 0.7);
      padding: 8px 15px;
      border-radius: 8px;
      border: 1px solid #ffd700;
      font-size: 0.9rem;
      box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
    }
    
    .stat-value {
      color: #ffd700;
      font-weight: bold;
    }
    
    .bonus-active {
      color: #00ff00 !important;
      animation: pulse 1s infinite;
    }
    
    @keyframes pulse {
      0% { opacity: 1; }
      50% { opacity: 0.5; }
      100% { opacity: 1; }
    }
    
    canvas {
      display: block;
      width: 100%;
      height: auto;
      border: 2px solid #ffd700;
      border-radius: 8px;
      box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
      background: #000000;
      touch-action: none;
    }
    
    .countdown {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 20;
      border-radius: 8px;
      font-size: 6rem;
      color: #ffd700;
      text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
      animation: countdownPulse 1s infinite;
    }
    
    @keyframes countdownPulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
    
    .game-over, .thanks-screen, .level-complete, .final-screen {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0, 0, 0, 0.95);
      padding: 25px;
      border-radius: 15px;
      text-align: center;
      border: 2px solid #ffd700;
      width: 85%;
      max-width: 320px;
      display: none;
      z-index: 10;
      box-shadow: 0 0 25px rgba(255, 215, 0, 0.6);
    }
    
    .thanks-screen, .level-complete, .final-screen {
      border-color: #ffd700;
    }
    
    .game-over h2, .thanks-screen h2, .level-complete h2, .final-screen h2 {
      margin-bottom: 15px;
      font-size: 1.6rem;
      color: #ffd700;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }
    
    .thanks-message {
      font-size: 1.1rem;
      margin-bottom: 15px;
      line-height: 1.4;
      color: #ffffff;
    }
    
    .final-message {
      font-size: 1.2rem;
      margin-bottom: 20px;
      line-height: 1.5;
      color: #ffd700;
      font-weight: bold;
    }
    
    .bonus-earned {
      font-size: 1.4rem;
      color: #ffd700;
      font-weight: bold;
      margin: 15px 0;
      animation: glow 2s infinite;
    }
    
    @keyframes glow {
      0% { text-shadow: 0 0 5px #ffd700; }
      50% { text-shadow: 0 0 20px #ffd700, 0 0 30px #ffd700; }
      100% { text-shadow: 0 0 5px #ffd700; }
    }
    
    .btn {
      background: #ffd700;
      color: #000;
      border: none;
      padding: 12px 24px;
      font-size: 1.1rem;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 10px;
      font-weight: bold;
      width: 100%;
      transition: all 0.3s;
      box-shadow: 0 4px 8px rgba(255, 215, 0, 0.3);
    }
    
    .btn:hover {
      background: #ffed4e;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(255, 215, 0, 0.4);
    }
    
    .btn:active {
      background: #ffed4e;
      transform: scale(0.98);
    }
    
    .whatsapp-btn {
      background: #25D366;
      color: white;
      border: none;
      padding: 14px 24px;
      font-size: 1.2rem;
      border-radius: 8px;
      cursor: pointer;
      margin-top: 15px;
      font-weight: bold;
      width: 100%;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      box-shadow: 0 4px 8px rgba(37, 211, 102, 0.3);
      text-decoration: none;
    }
    
    .whatsapp-btn:hover {
      background: #20b858;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(37, 211, 102, 0.4);
    }
    
    .whatsapp-btn:active {
      background: #1ca64d;
      transform: scale(0.98);
    }
    
    .controls-info {
      margin-top: 10px;
      font-size: 0.8rem;
      color: #aaa;
      text-align: center;
    }
    
    .social-controls {
      margin-top: 10px;
      display: flex;
      justify-content: center;
      gap: 10px;
    }
    
    .social-btn {
      background: rgba(255, 215, 0, 0.2);
      border: 1px solid #ffd700;
      border-radius: 8px;
      padding: 10px 15px;
      font-size: 0.9rem;
      color: #ffd700;
      cursor: pointer;
      transition: all 0.3s;
      text-decoration: none;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 5px;
      min-width: 120px;
    }
    
    .social-btn:hover {
      background: rgba(255, 215, 0, 0.3);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(255, 215, 0, 0.2);
    }
    
    .social-btn:active {
      transform: scale(0.98);
    }
    
    .bonus-text {
      position: absolute;
      top: 40%;
      left: 50%;
      transform: translate(-50%, -50%);
      font-size: 2rem;
      font-weight: bold;
      text-align: center;
      color: #ffffff;
      text-shadow: 0 0 10px rgba(255, 255, 255, 0.7);
      z-index: 5;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.5s;
    }
    
    .december-text {
      color: #00FFFF;
      text-shadow: 0 0 15px rgba(0, 255, 255, 0.8);
    }
    
    .agency-text {
      color: #00FF00;
      text-shadow: 0 0 15px rgba(0, 255, 0, 0.8);
    }
    
    .duet-text {
      color: #FF69B4;
      text-shadow: 0 0 15px rgba(255, 105, 180, 0.8);
    }
    
    .extend-text {
      color: #FFA500;
      text-shadow: 0 0 15px rgba(255, 165, 0, 0.8);
    }
    
    .laser-text {
      color: #FF0000;
      text-shadow: 0 0 15px rgba(255, 0, 0, 0.8);
    }
    
    .catch-text {
      color: #00CED1;
      text-shadow: 0 0 15px rgba(0, 206, 209, 0.8);
    }
    
    .slow-text {
      color: #9370DB;
      text-shadow: 0 0 15px rgba(147, 112, 219, 0.8);
    }
    
    .disruption-text {
      color: #1E90FF;
      text-shadow: 0 0 15px rgba(30, 144, 255, 0.8);
    }
    
    .player-text {
      color: #C0C0C0;
      text-shadow: 0 0 15px rgba(192, 192, 192, 0.8);
    }
    
    .combo-text {
      color: #FF4500;
      text-shadow: 0 0 15px rgba(255, 69, 0, 0.8);
      font-size: 2.5rem;
    }
    
    .snowflake {
      position: absolute;
      color: #ffffff;
      font-size: 20px;
      pointer-events: none;
      z-index: 5;
    }
    
    .combo-effect {
      position: absolute;
      color: #FFD700;
      font-size: 24px;
      font-weight: bold;
      z-index: 6;
      pointer-events: none;
      animation: comboFloat 2s ease-out forwards;
    }
    
    @keyframes comboFloat {
      0% {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) scale(1.5);
        opacity: 0;
      }
    }

    .final-score {
      font-size: 2rem;
      color: #ffd700;
      font-weight: bold;
      margin: 15px 0;
      text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
    }

    .congratulations {
      font-size: 1.3rem;
      color: #00ff00;
      font-weight: bold;
      margin-bottom: 10px;
      text-shadow: 0 0 10px rgba(0, 255, 0, 0.5);
    }
  </style>
</head>
<body>
  <div class="game-container">
    <div class="game-header">
      <h1 class="game-title">PERVUSHIN.EVENT</h1>
      <div class="game-stats">
        <div class="stat">–ì–û–ù–û–†–ê–†: <span id="score">0</span></div>
        <div class="stat">–£—Ä–æ–≤–µ–Ω—å: <span id="level">1</span></div>
        <div class="stat">–°–ï–ó–û–ù: <span id="lives">3</span></div>
        <div class="stat">–ë–û–ù–£–°: <span id="bonus">–ù–ï–¢</span></div>
      </div>
    </div>
    
    <canvas id="game"></canvas>
    
    <div class="countdown" id="countdown">5</div>
    
    <div class="bonus-text december-text" id="decemberText">–î–ï–ö–ê–ë–†–¨ - –ú–ï–°–Ø–¶ –í–û–ó–ú–û–ñ–ù–û–°–¢–ï–ô</div>
    <div class="bonus-text agency-text" id="agencyText">–í–´ –¢–ï–ü–ï–†–¨ –†–ê–ë–û–¢–ê–ï–¢–ï –° –ê–ì–ï–ù–¢–°–¢–í–û–ú</div>
    <div class="bonus-text duet-text" id="duetText">–í–´ –†–ê–ë–û–¢–ê–ï–¢–ï –í –î–£–≠–¢–ï</div>
    <div class="bonus-text extend-text" id="extendText">–í–´ –•–û–†–û–®–û –í–´–°–ü–ê–õ–ò–°–¨ –ò –ì–û–¢–û–í–´ –†–ê–ë–û–¢–ê–¢–¨ –õ–£–ß–®–ï</div>
    <div class="bonus-text laser-text" id="laserText">–õ–ê–ó–ï–†–ù–ê–Ø –ü–£–®–ö–ê –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ê!</div>
    <div class="bonus-text catch-text" id="catchText">–ú–ê–ì–ù–ò–¢ –ê–ö–¢–ò–í–ò–†–û–í–ê–ù!</div>
    <div class="bonus-text slow-text" id="slowText">–ó–ê–ú–ï–î–õ–ï–ù–ò–ï –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–û!</div>
    <div class="bonus-text disruption-text" id="disruptionText">–†–ê–ó–î–ï–õ–ï–ù–ò–ï –®–ê–†–ê!</div>
    <div class="bonus-text player-text" id="playerText">+2 –ñ–ò–ó–ù–ò!</div>
    <div class="bonus-text combo-text" id="comboText">–ö–û–ú–ë–û! x5</div>
    
    <div class="game-over" id="gameOver">
      <h2>–ò–ì–†–ê –û–ö–û–ù–ß–ï–ù–ê</h2>
      <p>–í–∞—à –ì–û–ù–û–†–ê–†: <span id="finalScore">0</span></p>
      <button class="btn" id="restartBtn">–ò–≥—Ä–∞—Ç—å —Å–Ω–æ–≤–∞</button>
    </div>
    
    <div class="thanks-screen" id="thanksScreen">
      <h2>–ë–õ–ê–ì–û–î–ê–†–ù–û–°–¢–¨</h2>
      <div class="thanks-message">
        –ï–≤–≥–µ–Ω–∏–π –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç –≤–∞—Å –∑–∞ –ø–æ–º–æ—â—å –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è!
      </div>
      <div class="bonus-earned">
        +<span id="bonusAmount">0</span> –ì–û–ù–û–†–ê–†–ê
      </div>
      <button class="btn" id="continueBtn">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
    </div>
    
    <div class="level-complete" id="levelComplete">
      <h2>–£–†–û–í–ï–ù–¨ –ü–†–û–ô–î–ï–ù!</h2>
      <p>–í—ã –∑–∞—Ä–∞–±–æ—Ç–∞–ª–∏: <span id="levelScore">0</span> –ì–û–ù–û–†–ê–†–ê</p>
      <button class="btn" id="nextLevelBtn">–°–ª–µ–¥—É—é—â–∏–π —É—Ä–æ–≤–µ–Ω—å</button>
    </div>
    
    <div class="final-screen" id="finalScreen">
      <h2>üéâ –ü–û–ó–î–†–ê–í–õ–Ø–Æ! üéâ</h2>
      <div class="congratulations">–í—ã –ø—Ä–æ—à–ª–∏ –≤—Å–µ —É—Ä–æ–≤–Ω–∏!</div>
      <div class="final-message">
        –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–º–æ—â—å –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π! –í–∞—à –≤–∫–ª–∞–¥ –Ω–µ–æ—Ü–µ–Ω–∏–º!
      </div>
      <div class="final-score">
        –ì–û–ù–û–†–ê–†: <span id="totalScore">0</span>
      </div>
      <div class="thanks-message">
        –•–æ—Ç–∏—Ç–µ –æ–±—Å—É–¥–∏—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–æ?
      </div>
      <a href="https://wa.me/79993053019" class="whatsapp-btn" target="_blank" id="whatsappBtn">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
          <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893-.001-3.189-1.262-6.187-3.55-8.444"/>
        </svg>
        –ù–∞–ø–∏—Å–∞—Ç—å –≤ WhatsApp
      </a>
      <button class="btn" id="finalRestartBtn">–ò–≥—Ä–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
    </div>
  </div>

  <div class="controls-info">
    –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Å–∞–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π
  </div>
  
  <div class="social-controls">
    <a href="#" class="social-btn" id="shareBtn">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
      </svg>
      –ü–æ–¥–µ–ª–∏—Ç—å—Å—è
    </a>
    <a href="https://www.instagram.com/pervushin.event?igsh=MWIxb2ptYWRjZTV3Yg%3D%3D&utm_source=qr" class="social-btn" target="_blank">
      <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
        <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
      </svg>
      Instagram
    </a>
  </div>

  <script>
    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤
    const canvas = document.getElementById('game');
    const context = canvas.getContext('2d');
    const countdownElement = document.getElementById('countdown');
    const gameOverScreen = document.getElementById('gameOver');
    const thanksScreen = document.getElementById('thanksScreen');
    const levelCompleteScreen = document.getElementById('levelComplete');
    const finalScreen = document.getElementById('finalScreen');
    const decemberText = document.getElementById('decemberText');
    const agencyText = document.getElementById('agencyText');
    const duetText = document.getElementById('duetText');
    const extendText = document.getElementById('extendText');
    const laserText = document.getElementById('laserText');
    const catchText = document.getElementById('catchText');
    const slowText = document.getElementById('slowText');
    const disruptionText = document.getElementById('disruptionText');
    const playerText = document.getElementById('playerText');
    const comboText = document.getElementById('comboText');
    const whatsappBtn = document.getElementById('whatsappBtn');
    const finalRestartBtn = document.getElementById('finalRestartBtn');
    const shareBtn = document.getElementById('shareBtn');
    
    // –ò–≥—Ä–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
    let gameStarted = false;
    let gameRunning = false;
    let score = 0;
    let level = 1;
    let lives = 3;
    let bonusActive = false;
    let bonusMultiplier = 1;
    let countdown = 5;
    let ballLost = false;
    let paddleWidth = 80;
    let decemberBonusActive = false;
    let lightningBonusActive = false;
    let megaBallActive = false;
    let bigBallBonusActive = false;
    let snowEffectActive = false;
    let comboCount = 0;
    let screenShake = 0;
    let comboEffects = [];
    
    // –ù–æ–≤—ã–µ –±–æ–Ω—É—Å—ã
    let duetBonusActive = false;
    let extendBonusActive = false;
    let laserBonusActive = false;
    let catchBonusActive = false;
    let slowBonusActive = false;
    let disruptionBonusActive = false;
    let playerBonusActive = false;
    
    // –¢–∞–π–º–µ—Ä—ã –¥–ª—è –±–æ–Ω—É—Å–æ–≤
    let bonusTimers = {
      laser: 0,
      catch: 0,
      slow: 0
    };
    
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
    let keys = {
      left: false,
      right: false
    };
    
    // –†–∞–∑–º–µ—Ä—ã
    const brickWidth = 25;
    const brickHeight = 12;
    const brickGap = 2;
    const wallSize = 12;
    const bricksPerRow = 13;
    const totalRows = 16;
    
    // –®–ö–ê–õ–ê –ì–û–ù–û–†–ê–†–û–í
    const brickRewards = {
      'A': 10000,  // –ê–ö–°–£
      'P': 50000,  // –ü–í–õ
      'N': 80000,  // –ù–°–ö
      'S': 100000, // –°–ü–ë
      'M': 150000, // –ú–°–ö
      'D': 200000, // –î–ï–ö–ê–ë–†–¨
      'L': 250000, // –ú–û–õ–ù–ò–Ø
      'B': 300000, // MEGA BALL
      'T': 350000, // TWIN - –±–æ–Ω—É—Å "–î—É—ç—Ç"
      'E': 400000, // EXTEND - –±–æ–Ω—É—Å "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"
      'R': 450000, // LASER - –±–æ–Ω—É—Å "–õ–∞–∑–µ—Ä"
      'C': 500000, // CATCH - –±–æ–Ω—É—Å "–ú–∞–≥–Ω–∏—Ç"
      'O': 550000, // SLOW - –±–æ–Ω—É—Å "–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ"
      'U': 650000, // DISRUPTION - –±–æ–Ω—É—Å "–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ"
      'I': 700000  // PLAYER - –±–æ–Ω—É—Å "+2 –∂–∏–∑–Ω–∏"
    };
    
    // –¶–≤–µ—Ç–∞ –∫–∏—Ä–ø–∏—á–µ–π
    const brickColors = {
      'M': { color: '#FFFFFF', textColor: '#000000', city: '–ú–°–ö' },
      'S': { color: '#0000FF', textColor: '#FFFFFF', city: '–°–ü–ë' },
      'N': { color: '#FF0000', textColor: '#FFFFFF', city: '–ù–°–ö' },
      'P': { color: '#0000FF', textColor: '#FFD700', city: '–ü–í–õ' },
      'A': { color: '#0000FF', textColor: '#FFD700', city: '–ê–ö–°–£' },
      'D': { color: '#00FFFF', textColor: '#000000', city: '–î–ï–ö–ê–ë–†–¨' },
      'L': { color: '#FFFF00', textColor: '#000000', city: '‚ö°' },
      'B': { color: '#FF00FF', textColor: '#000000', city: 'MEGA' },
      'T': { color: '#FF69B4', textColor: '#000000', city: 'TWIN' },
      'E': { color: '#FFA500', textColor: '#000000', city: 'EXTEND' },
      'R': { color: '#FF0000', textColor: '#FFFFFF', city: 'LASER' },
      'C': { color: '#00CED1', textColor: '#000000', city: 'CATCH' },
      'O': { color: '#9370DB', textColor: '#000000', city: '‚è±Ô∏è' },
      'U': { color: '#1E90FF', textColor: '#000000', city: 'SPLIT' },
      'I': { color: '#C0C0C0', textColor: '#000000', city: 'LIFE' }
    };

    // –£—Ä–æ–≤–Ω–∏
    const levels = [
      Array(totalRows).fill().map((_, rowIndex) => 
        Array(bricksPerRow).fill().map((_, colIndex) => {
          if (rowIndex < 4) return 'M';
          if (rowIndex < 6) return 'S';
          if (rowIndex < 8) return 'N';
          if (rowIndex < 11) return 'P';
          return 'A';
        })
      )
    ];

    // –ò–≥—Ä–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
    let bricks = [];
    let bonuses = [];
    let particles = [];
    let balls = [];
    let decemberBonuses = [];
    let lightningBonuses = [];
    let lightningEffects = [];
    let bigBallBonuses = [];
    let snowflakes = [];
    let comboSmileys = [];
    let twinBonuses = [];
    let extendBonuses = [];
    let laserBonuses = [];
    let catchBonuses = [];
    let slowBonuses = [];
    let disruptionBonuses = [];
    let playerBonuses = [];
    let lasers = [];
    let rewardTexts = [];
    
    const paddle = {
      x: 0,
      y: 0,
      width: paddleWidth,
      height: 12,
      speed: 8
    };
    
    const paddle2 = {
      x: 0,
      y: 0,
      width: paddleWidth / 2,
      height: 12,
      speed: 8
    };
    
    const mainBall = {
      x: 0,
      y: 0,
      width: 8,
      height: 8,
      dx: 0,
      dy: 0,
      speed: 5
    };

    // –§—É–Ω–∫—Ü–∏—è –≤–∏–±—Ä–∞—Ü–∏–∏
    function vibrate() {
      if (navigator.vibrate) {
        navigator.vibrate(50);
      }
    }

    // –§—É–Ω–∫—Ü–∏—è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è
    function shareGame() {
      const shareData = {
        title: 'PERVUSHIN.EVENT - –ê—Ä–∫–∞–Ω–æ–∏–¥',
        text: '–°—ã–≥—Ä–∞–π –≤ —É–≤–ª–µ–∫–∞—Ç–µ–ª—å–Ω—É—é –∏–≥—Ä—É PERVUSHIN.EVENT! –ü–æ–º–æ–≥–∏ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –∏ –∑–∞—Ä–∞–±–æ—Ç–∞–π –≥–æ–Ω–æ—Ä–∞—Ä! üéÆ',
        url: window.location.href
      };
      
      if (navigator.share) {
        navigator.share(shareData)
          .then(() => console.log('–£—Å–ø–µ—à–Ω—ã–π —à–∞—Ä–∏–Ω–≥'))
          .catch((error) => console.log('–û—à–∏–±–∫–∞ —à–∞—Ä–∏–Ω–≥–∞:', error));
      } else {
        // Fallback - –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞
        navigator.clipboard.writeText(window.location.href)
          .then(() => {
            alert('–°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞! –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –∏–≥—Ä–æ–π —Å –¥—Ä—É–∑—å—è–º–∏!');
          })
          .catch(() => {
            alert('–ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å—Å—ã–ª–∫–æ–π: ' + window.location.href);
          });
      }
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã
    function initGame() {
      resizeCanvas();
      createLevel();
      resetBall();
      updateStats();
      startCountdown();
    }

    // –û–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á–µ—Ç
    function startCountdown() {
      const countdownInterval = setInterval(() => {
        countdown--;
        countdownElement.textContent = countdown;
        
        if (countdown <= 0) {
          clearInterval(countdownInterval);
          countdownElement.style.display = 'none';
          startGame();
        }
      }, 1000);
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –≤—Å–µ—Ö –±–æ–Ω—É—Å–Ω—ã—Ö –∫–∏—Ä–ø–∏—á–µ–π
    function createLevel() {
      bricks = [];
      const levelData = levels[level - 1];
      
      // –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º –≤—Å–µ –æ–±—ã—á–Ω—ã–µ –∫–∏—Ä–ø–∏—á–∏
      for (let row = 0; row < levelData.length; row++) {
        for (let col = 0; col < levelData[row].length; col++) {
          const type = levelData[row][col];
          if (!type) continue;
          
          const brickInfo = brickColors[type];
          bricks.push({
            x: wallSize + (brickWidth + brickGap) * col,
            y: wallSize + (brickHeight + brickGap) * row,
            width: brickWidth,
            height: brickHeight,
            color: brickInfo.color,
            textColor: brickInfo.textColor,
            city: brickInfo.city,
            type: type,
            reward: brickRewards[type]
          });
        }
      }
      
      // –¢–µ–ø–µ—Ä—å –¥–æ–±–∞–≤–ª—è–µ–º –í–°–ï –±–æ–Ω—É—Å–Ω—ã–µ –∫–∏—Ä–ø–∏—á–∏ –≤ —Å–ª—É—á–∞–π–Ω—ã–µ –ø–æ–∑–∏—Ü–∏–∏
      const bonusBricks = ['D', 'L', 'B', 'T', 'E', 'R', 'C', 'O', 'U', 'I'];
      const usedPositions = new Set();
      
      bonusBricks.forEach(bonusType => {
        let attempts = 0;
        let added = false;
        
        while (attempts < 100 && !added) {
          attempts++;
          
          const randomRow = Math.floor(Math.random() * totalRows);
          const randomCol = Math.floor(Math.random() * bricksPerRow);
          const positionKey = `${randomRow}-${randomCol}`;
          
          if (!usedPositions.has(positionKey)) {
            const brickIndex = bricks.findIndex(brick => {
              const brickRow = Math.floor((brick.y - wallSize) / (brickHeight + brickGap));
              const brickCol = Math.floor((brick.x - wallSize) / (brickWidth + brickGap));
              return brickRow === randomRow && brickCol === randomCol;
            });
            
            if (brickIndex !== -1) {
              const brickInfo = brickColors[bonusType];
              bricks[brickIndex] = {
                x: wallSize + (brickWidth + brickGap) * randomCol,
                y: wallSize + (brickHeight + brickGap) * randomRow,
                width: brickWidth,
                height: brickHeight,
                color: brickInfo.color,
                textColor: brickInfo.textColor,
                city: brickInfo.city,
                type: bonusType,
                reward: brickRewards[bonusType]
              };
              
              usedPositions.add(positionKey);
              added = true;
            }
          }
        }
      });
    }

    // –°–±—Ä–æ—Å –º—è—á–∞
    function resetBall() {
      balls = [];
      
      mainBall.x = paddle.x + paddle.width / 2 - mainBall.width / 2;
      mainBall.y = paddle.y - mainBall.height - 5;
      mainBall.dx = 0;
      mainBall.dy = 0;
      
      balls.push({...mainBall});
      
      ballLost = false;
      megaBallActive = false;
      bigBallBonusActive = false;
      comboCount = 0;
      
      // –°–±—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –º—è—á–∞
      duetBonusActive = false;
      laserBonusActive = false;
      catchBonusActive = false;
      slowBonusActive = false;
      disruptionBonusActive = false;
      playerBonusActive = false;
      
      // –°–±—Ä–æ—Å —Ç–∞–π–º–µ—Ä–æ–≤
      bonusTimers = {
        laser: 0,
        catch: 0,
        slow: 0
      };
      
      // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ —à–∞—Ä–æ–≤
      balls.forEach(ball => {
        ball.speed = 5;
      });
      
      paddle.width = paddleWidth;
      paddle2.width = paddleWidth / 2;
    }

    // –ó–∞–ø—É—Å–∫ –º—è—á–∞
    function launchBall() {
      balls.forEach(ball => {
        if (ball.dx === 0 && ball.dy === 0) {
          // –ü—Ä–∏ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –º–∞–≥–Ω–∏—Ç–µ –º—è—á –ª–µ—Ç–∏—Ç —Å—Ç—Ä–æ–≥–æ –≤–≤–µ—Ä—Ö
          if (catchBonusActive) {
            ball.dx = 0;
            ball.dy = -ball.speed;
          } else {
            const angle = (Math.random() * 120 - 60) * Math.PI / 180;
            ball.dx = Math.cos(angle) * ball.speed;
            ball.dy = Math.sin(angle) * ball.speed;
            
            if (ball.dy > 0) ball.dy = -ball.dy;
          }
        }
      });
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —à–∞—Ä–∏–∫–æ–≤ (–±–æ–Ω—É—Å "–î–µ–∫–∞–±—Ä—å")
    function createMultipleBalls() {
      for (let i = 0; i < 4; i++) {
        const newBall = {
          x: paddle.x + paddle.width / 2 - mainBall.width / 2,
          y: paddle.y - mainBall.height - 5,
          width: 8,
          height: 8,
          dx: 0,
          dy: 0,
          speed: 5
        };
        
        const angle = (Math.random() * 120 - 60) * Math.PI / 180;
        newBall.dx = Math.cos(angle) * newBall.speed;
        newBall.dy = Math.sin(angle) * newBall.speed;
        
        if (newBall.dy > 0) newBall.dy = -Math.abs(newBall.dy);
        
        balls.push(newBall);
      }
      
      activateDecemberBonus();
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–î–µ–∫–∞–±—Ä—å"
    function activateDecemberBonus() {
      decemberBonusActive = true;
      snowEffectActive = true;
      
      decemberText.style.opacity = '1';
      createSnowEffect();
      
      setTimeout(() => {
        decemberText.style.opacity = '0';
      }, 3000);
      
      setTimeout(() => {
        snowEffectActive = false;
      }, 5000);
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–Ω–µ–≥–æ–ø–∞–¥–∞
    function createSnowEffect() {
      for (let i = 0; i < 30; i++) {
        snowflakes.push({
          x: Math.random() * canvas.width,
          y: Math.random() * -100,
          size: Math.random() * 15 + 10,
          speed: Math.random() * 2 + 1,
          text: "‚ùÑ"
        });
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ —Å–Ω–µ–≥–æ–ø–∞–¥–∞
    function updateSnowEffect() {
      for (let i = snowflakes.length - 1; i >= 0; i--) {
        const snowflake = snowflakes[i];
        snowflake.y += snowflake.speed;
        
        if (snowflake.y > canvas.height) {
          snowflakes.splice(i, 1);
        }
      }
      
      if (snowEffectActive && Math.random() < 0.1) {
        snowflakes.push({
          x: Math.random() * canvas.width,
          y: -20,
          size: Math.random() * 15 + 10,
          speed: Math.random() * 2 + 1,
          text: "‚ùÑ"
        });
      }
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–ê–≥–µ–Ω—Ç—Å—Ç–≤–æ"
    function activateAgencyBonus() {
      bonusActive = true;
      bonusMultiplier = 2;
      
      agencyText.style.opacity = '1';
      
      setTimeout(() => {
        agencyText.style.opacity = '0';
      }, 3000);
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–î—É—ç—Ç"
    function activateDuetBonus() {
      duetBonusActive = true;
      
      duetText.style.opacity = '1';
      
      setTimeout(() => {
        duetText.style.opacity = '0';
      }, 3000);
      
      paddle.width = paddleWidth / 2;
      paddle2.width = paddleWidth / 2;
      
      paddle2.x = paddle.x + paddle.width + 10;
      paddle2.y = paddle.y;
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–£–≤–µ–ª–∏—á–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã"
    function activateExtendBonus() {
      extendBonusActive = true;
      // –î–ª–∏—Ç—Å—è –¥–æ –ø–µ—Ä–≤–æ–π –ø–æ—Ç–µ—Ä–∏ —à–∞—Ä–∏–∫–∞
      
      extendText.style.opacity = '1';
      
      setTimeout(() => {
        extendText.style.opacity = '0';
      }, 3000);
      
      paddle.width = paddleWidth * 1.5;
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–õ–∞–∑–µ—Ä"
    function activateLaserBonus() {
      laserBonusActive = true;
      bonusTimers.laser = 1200; // 20 —Å–µ–∫—É–Ω–¥ –ø—Ä–∏ 60 FPS
      
      laserText.style.opacity = '1';
      
      setTimeout(() => {
        laserText.style.opacity = '0';
      }, 3000);
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–ú–∞–≥–Ω–∏—Ç"
    function activateCatchBonus() {
      catchBonusActive = true;
      bonusTimers.catch = 1800; // 30 —Å–µ–∫—É–Ω–¥
      
      catchText.style.opacity = '1';
      
      setTimeout(() => {
        catchText.style.opacity = '0';
      }, 3000);
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–ó–∞–º–µ–¥–ª–µ–Ω–∏–µ"
    function activateSlowBonus() {
      slowBonusActive = true;
      bonusTimers.slow = 1800; // 30 —Å–µ–∫—É–Ω–¥
      
      slowText.style.opacity = '1';
      
      setTimeout(() => {
        slowText.style.opacity = '0';
      }, 3000);
      
      // –ó–∞–º–µ–¥–ª—è–µ–º –≤—Å–µ —à–∞—Ä—ã
      balls.forEach(ball => {
        ball.dx *= 0.5;
        ball.dy *= 0.5;
        ball.speed *= 0.5;
      });
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ"
    function activateDisruptionBonus() {
      disruptionBonusActive = true;
      
      disruptionText.style.opacity = '1';
      
      setTimeout(() => {
        disruptionText.style.opacity = '0';
      }, 3000);
      
      // –°–æ–∑–¥–∞–µ–º 2 –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —à–∞—Ä–∞ –∏–∑ –∫–∞–∂–¥–æ–≥–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ
      const currentBalls = [...balls];
      currentBalls.forEach(ball => {
        for (let i = 0; i < 2; i++) {
          const newBall = {
            x: ball.x,
            y: ball.y,
            width: ball.width,
            height: ball.height,
            dx: ball.dx + (Math.random() - 0.5) * 2,
            dy: ball.dy + (Math.random() - 0.5) * 2,
            speed: ball.speed
          };
          balls.push(newBall);
        }
      });
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –±–æ–Ω—É—Å–∞ "+2 –∂–∏–∑–Ω–∏"
    function activatePlayerBonus() {
      playerBonusActive = true;
      lives += 2;
      
      playerText.style.opacity = '1';
      
      setTimeout(() => {
        playerText.style.opacity = '0';
      }, 3000);
      
      updateStats();
    }

    // –°—Ç—Ä–µ–ª—å–±–∞ –ª–∞–∑–µ—Ä–æ–º
    function shootLaser() {
      if (!laserBonusActive) return;
      
      // –°–æ–∑–¥–∞–µ–º –¥–≤–∞ –ª–∞–∑–µ—Ä–∞ –ø–æ –∫—Ä–∞—è–º –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
      lasers.push({
        x: paddle.x + 10,
        y: paddle.y,
        width: 3,
        height: 15,
        speed: 10
      });
      
      lasers.push({
        x: paddle.x + paddle.width - 10,
        y: paddle.y,
        width: 3,
        height: 15,
        speed: 10
      });
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ª–∞–∑–µ—Ä–æ–≤
    function updateLasers() {
      for (let i = lasers.length - 1; i >= 0; i--) {
        const laser = lasers[i];
        laser.y -= laser.speed;
        
        if (laser.y < 0) {
          lasers.splice(i, 1);
          continue;
        }
        
        for (let j = bricks.length - 1; j >= 0; j--) {
          const brick = bricks[j];
          if (checkCollision(laser, brick)) {
            const reward = brick.reward * bonusMultiplier;
            score += reward;
            createRewardText(brick.x + brick.width/2, brick.y + brick.height/2, reward);
            createBrickBreakEffect(brick.x + brick.width/2, brick.y + brick.height/2, brick.color);
            bricks.splice(j, 1);
            lasers.splice(i, 1);
            break;
          }
        }
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–æ–≤ –±–æ–Ω—É—Å–æ–≤
    function updateBonusTimers() {
      // –õ–∞–∑–µ—Ä (20 —Å–µ–∫—É–Ω–¥)
      if (bonusTimers.laser > 0) {
        bonusTimers.laser--;
        if (bonusTimers.laser === 0) {
          laserBonusActive = false;
        }
      }
      
      // –ú–∞–≥–Ω–∏—Ç (30 —Å–µ–∫—É–Ω–¥)
      if (bonusTimers.catch > 0) {
        bonusTimers.catch--;
        if (bonusTimers.catch === 0) {
          catchBonusActive = false;
        }
      }
      
      // –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ (30 —Å–µ–∫—É–Ω–¥)
      if (bonusTimers.slow > 0) {
        bonusTimers.slow--;
        if (bonusTimers.slow === 0) {
          slowBonusActive = false;
          // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å —à–∞—Ä–æ–≤
          balls.forEach(ball => {
            ball.dx *= 2;
            ball.dy *= 2;
            ball.speed *= 2;
          });
        }
      }
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –∫–æ–º–±–æ
    function activateComboEffect(count) {
      screenShake = 20;
      
      comboText.textContent = `–ö–û–ú–ë–û! x${count}`;
      comboText.style.opacity = '1';
      
      createComboSmileys(count);
      
      setTimeout(() => {
        comboText.style.opacity = '0';
      }, 2000);
      
      if (navigator.vibrate) {
        navigator.vibrate(200);
      }
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —Å–º–∞–π–ª–∏–∫–æ–≤ –¥–ª—è –∫–æ–º–±–æ
    function createComboSmileys(count) {
      const smileys = ["üòé", "üî•", "üí•", "üöÄ", "‚≠ê", "üéØ", "üëë", "üíé"];
      
      for (let i = 0; i < count * 2; i++) {
        comboSmileys.push({
          x: Math.random() * canvas.width,
          y: canvas.height + 20,
          dx: (Math.random() - 0.5) * 4,
          dy: -Math.random() * 3 - 2,
          size: Math.random() * 20 + 15,
          text: smileys[Math.floor(Math.random() * smileys.length)],
          life: 60
        });
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–º–∞–π–ª–∏–∫–æ–≤ –∫–æ–º–±–æ
    function updateComboSmileys() {
      for (let i = comboSmileys.length - 1; i >= 0; i--) {
        const smiley = comboSmileys[i];
        smiley.x += smiley.dx;
        smiley.y += smiley.dy;
        smiley.life--;
        
        if (smiley.life <= 0 || smiley.y < -50) {
          comboSmileys.splice(i, 1);
        }
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä—è—Å–∫–∏ —ç–∫—Ä–∞–Ω–∞
    function updateScreenShake() {
      if (screenShake > 0) {
        screenShake--;
        return {
          x: (Math.random() - 0.5) * screenShake,
          y: (Math.random() - 0.5) * screenShake
        };
      }
      return { x: 0, y: 0 };
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è Mega-—à–∞—Ä–∞
    function activateMegaBall() {
      megaBallActive = true;
      lightningBonusActive = true;
      
      balls.forEach(ball => {
        ball.width = 16;
        ball.height = 16;
        ball.speed = 7;
      });
      
      setTimeout(() => {
        megaBallActive = false;
        lightningBonusActive = false;
        
        balls.forEach(ball => {
          ball.width = 8;
          ball.height = 8;
          ball.speed = 5;
        });
      }, 10000);
    }

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è Big Ball
    function activateBigBall() {
      bigBallBonusActive = true;
      
      balls.forEach(ball => {
        ball.width = 24;
        ball.height = 24;
        ball.speed = 6;
      });
      
      setTimeout(() => {
        bigBallBonusActive = false;
        
        balls.forEach(ball => {
          ball.width = 8;
          ball.height = 8;
          ball.speed = 5;
        });
      }, 8000);
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∞ –º–æ–ª–Ω–∏–∏
    function createLightningEffect(x, y) {
      lightningEffects.push({
        x: x,
        y: y,
        life: 10,
        segments: []
      });
      
      const segmentCount = 5;
      let lastX = x;
      let lastY = y;
      
      for (let i = 0; i < segmentCount; i++) {
        const segment = {
          x1: lastX,
          y1: lastY,
          x2: lastX + (Math.random() - 0.5) * 20,
          y2: lastY - 20 - Math.random() * 10
        };
        lightningEffects[lightningEffects.length - 1].segments.push(segment);
        lastX = segment.x2;
        lastY = segment.y2;
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
    function updateStats() {
      document.getElementById('score').textContent = score.toLocaleString();
      document.getElementById('level').textContent = level;
      document.getElementById('lives').textContent = lives;
      
      let bonusText = '–ù–ï–¢';
      if (bonusActive) {
        bonusText = 'x2 –ì–û–ù–û–†–ê–†!';
      } else if (decemberBonusActive) {
        bonusText = '5 –®–ê–†–ò–ö–û–í!';
      } else if (lightningBonusActive) {
        bonusText = 'MEGA-–®–ê–†!';
      } else if (bigBallBonusActive) {
        bonusText = 'BIG BALL!';
      } else if (duetBonusActive) {
        bonusText = '–î–£–≠–¢!';
      } else if (extendBonusActive) {
        bonusText = '–£–í–ï–õ–ò–ß–ï–ù–ò–ï!';
      } else if (laserBonusActive) {
        bonusText = '–õ–ê–ó–ï–†!';
      } else if (catchBonusActive) {
        bonusText = '–ú–ê–ì–ù–ò–¢!';
      } else if (slowBonusActive) {
        bonusText = '–ó–ê–ú–ï–î–õ–ï–ù–ò–ï!';
      } else if (disruptionBonusActive) {
        bonusText = '–†–ê–ó–î–ï–õ–ï–ù–ò–ï!';
      } else if (playerBonusActive) {
        bonusText = '+2 –ñ–ò–ó–ù–ò!';
      }
      
      document.getElementById('bonus').textContent = bonusText;
      
      if (bonusActive || decemberBonusActive || lightningBonusActive || bigBallBonusActive || 
          duetBonusActive || extendBonusActive || laserBonusActive || catchBonusActive ||
          slowBonusActive || disruptionBonusActive || playerBonusActive) {
        document.getElementById('bonus').classList.add('bonus-active');
      } else {
        document.getElementById('bonus').classList.remove('bonus-active');
      }
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–π
    function checkCollision(obj1, obj2) {
      return obj1.x < obj2.x + obj2.width &&
             obj1.x + obj1.width > obj2.x &&
             obj1.y < obj2.y + obj2.height &&
             obj1.y + obj1.height > obj2.y;
    }

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–∞—Å–∞–Ω–∏–π
    let touchX = 0;
    let isDragging = false;

    canvas.addEventListener('touchstart', (e) => {
      e.preventDefault();
      
      if (!gameStarted) return;
      
      const touch = e.touches[0];
      touchX = touch.clientX;
      isDragging = true;
      
      // –°—Ç—Ä–µ–ª—å–±–∞ –ª–∞–∑–µ—Ä–æ–º –ø—Ä–∏ –∫–∞—Å–∞–Ω–∏–∏
      if (laserBonusActive) {
        shootLaser();
      }
    });

    canvas.addEventListener('touchmove', (e) => {
      e.preventDefault();
      if (!isDragging || !gameStarted) return;
      
      const touch = e.touches[0];
      const deltaX = touch.clientX - touchX;
      
      paddle.x += deltaX * 2;
      
      if (duetBonusActive) {
        paddle2.x += deltaX * 2;
      }
      
      if (paddle.x < wallSize) paddle.x = wallSize;
      if (paddle.x + paddle.width > canvas.width - wallSize) {
        paddle.x = canvas.width - wallSize - paddle.width;
      }
      
      if (duetBonusActive) {
        if (paddle2.x < wallSize) paddle2.x = wallSize;
        if (paddle2.x + paddle2.width > canvas.width - wallSize) {
          paddle2.x = canvas.width - wallSize - paddle2.width;
        }
      }
      
      touchX = touch.clientX;
    });

    canvas.addEventListener('touchend', () => {
      isDragging = false;
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –∫–ª–∞–≤–∏—à
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        keys.left = true;
      } else if (e.key === 'ArrowRight') {
        keys.right = true;
      } else if (e.key === ' ' && laserBonusActive) {
        shootLaser();
      }
    });

    document.addEventListener('keyup', (e) => {
      if (e.key === 'ArrowLeft') {
        keys.left = false;
      } else if (e.key === 'ArrowRight') {
        keys.right = false;
      }
    });

    // –ö–Ω–æ–ø–∫–∞ –ø–æ–¥–µ–ª–∏—Ç—å—Å—è
    shareBtn.addEventListener('click', (e) => {
      e.preventDefault();
      shareGame();
    });

    // –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã
    function startGame() {
      gameStarted = true;
      gameRunning = true;
      launchBall();
      gameLoop();
    }

    // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –ø–æ—Ç–µ—Ä–∏ –º—è—á–∞
    function restartAfterBallLoss() {
      gameRunning = false;
      ballLost = true;
      countdown = 3;
      countdownElement.style.display = 'flex';
      countdownElement.textContent = countdown;
      
      const countdownInterval = setInterval(() => {
        countdown--;
        countdownElement.textContent = countdown;
        
        if (countdown <= 0) {
          clearInterval(countdownInterval);
          countdownElement.style.display = 'none';
          resetBall();
          gameRunning = true;
          launchBall();
          gameLoop();
        }
      }, 1000);
    }

    // –ò–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª
    function gameLoop() {
      if (!gameRunning) return;
      
      update();
      render();
      requestAnimationFrame(gameLoop);
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–≥—Ä—ã
    function update() {
      if (keys.left) {
        paddle.x -= paddle.speed;
        if (duetBonusActive) {
          paddle2.x -= paddle.speed;
        }
      }
      if (keys.right) {
        paddle.x += paddle.speed;
        if (duetBonusActive) {
          paddle2.x += paddle.speed;
        }
      }
      
      if (paddle.x < wallSize) paddle.x = wallSize;
      if (paddle.x + paddle.width > canvas.width - wallSize) {
        paddle.x = canvas.width - wallSize - paddle.width;
      }
      
      if (duetBonusActive) {
        if (paddle2.x < wallSize) paddle2.x = wallSize;
        if (paddle2.x + paddle2.width > canvas.width - wallSize) {
          paddle2.x = canvas.width - wallSize - paddle2.width;
        }
      }
      
      updateSnowEffect();
      updateComboSmileys();
      updateLasers();
      updateBonusTimers();
      
      for (let i = balls.length - 1; i >= 0; i--) {
        const ball = balls[i];
        
        ball.x += ball.dx;
        ball.y += ball.dy;
        
        if (ball.x < wallSize) {
          ball.x = wallSize;
          ball.dx = Math.abs(ball.dx);
        } else if (ball.x + ball.width > canvas.width - wallSize) {
          ball.x = canvas.width - wallSize - ball.width;
          ball.dx = -Math.abs(ball.dx);
        }
        
        if (ball.y < wallSize) {
          ball.y = wallSize;
          ball.dy = Math.abs(ball.dy);
        }
        
        if (ball.y > canvas.height) {
          if (!ballLost) {
            balls.splice(i, 1);
            
            if (bonusActive) {
              bonusActive = false;
              bonusMultiplier = 1;
              updateStats();
            }
            
            // –°–±—Ä–æ—Å –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–æ–Ω—É—Å–æ–≤ –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ –º—è—á–∞
            extendBonusActive = false;
            paddle.width = paddleWidth;
            
            comboCount = 0;
            
            if (balls.length === 0) {
              lives--;
              updateStats();
              if (lives <= 0) {
                gameOver();
              } else {
                restartAfterBallLoss();
              }
            }
          }
          continue;
        }
        
        let paddleHit = false;
        if (checkCollision(ball, paddle)) {
          paddleHit = true;
        } else if (duetBonusActive && checkCollision(ball, paddle2)) {
          paddleHit = true;
        }
        
        if (paddleHit) {
          if (catchBonusActive) {
            ball.dx = 0;
            ball.dy = 0;
            ball.x = paddle.x + paddle.width / 2 - ball.width / 2;
            ball.y = paddle.y - ball.height - 5;
            
            canvas.addEventListener('touchstart', function launchOnTouch() {
              launchBall();
              canvas.removeEventListener('touchstart', launchOnTouch);
            });
            
            document.addEventListener('keydown', function launchOnSpace(e) {
              if (e.key === ' ') {
                launchBall();
                document.removeEventListener('keydown', launchOnSpace);
              }
            });
          } else {
            const currentPaddle = (duetBonusActive && checkCollision(ball, paddle2)) ? paddle2 : paddle;
            
            const hitPos = (ball.x + ball.width/2 - currentPaddle.x) / currentPaddle.width;
            const normalizedHitPos = hitPos * 2 - 1;
            const maxBounceAngle = 75 * Math.PI / 180;
            const bounceAngle = normalizedHitPos * maxBounceAngle;
            
            const speed = Math.sqrt(ball.dx * ball.dx + ball.dy * ball.dy);
            ball.dx = Math.sin(bounceAngle) * speed;
            ball.dy = -Math.abs(Math.cos(bounceAngle) * speed);
            
            ball.y = currentPaddle.y - ball.height;
          }
          
          createHitEffect(paddle.x + paddle.width/2, paddle.y);
        }
        
        let bricksDestroyedThisHit = 0;
        for (let j = bricks.length - 1; j >= 0; j--) {
          const brick = bricks[j];
          if (checkCollision(ball, brick)) {
            vibrate();
            bricksDestroyedThisHit++;
            
            if (brick.type === 'S' && Math.random() < 0.3) {
              bonuses.push({
                x: brick.x,
                y: brick.y,
                width: brickWidth,
                height: brickHeight,
                text: "–ê–ì–ï–ù–¢–°–¢–í–û",
                color: "#00FF00",
                speed: 2
              });
            }
            
            if (brick.type === 'D') {
              decemberBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "‚ùÑ",
                color: "#FFFFFF",
                speed: 3
              });
            }
            
            if (brick.type === 'L') {
              lightningBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "‚ö°",
                color: "#FFFF00",
                speed: 3
              });
            }
            
            if (brick.type === 'B') {
              bigBallBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 20,
                height: 20,
                text: "‚ûï",
                color: "#FF00FF",
                speed: 2
              });
            }
            
            if (brick.type === 'T') {
              twinBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "üé§+",
                color: "#FF69B4",
                speed: 2
              });
            }
            
            if (brick.type === 'E') {
              extendBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "+",
                color: "#FFA500",
                speed: 2
              });
            }
            
            if (brick.type === 'R') {
              laserBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "üî´",
                color: "#FF0000",
                speed: 2
              });
            }
            
            if (brick.type === 'C') {
              catchBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "üß≤",
                color: "#00CED1",
                speed: 2
              });
            }
            
            if (brick.type === 'O') {
              slowBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "‚è±Ô∏è",
                color: "#9370DB",
                speed: 2
              });
            }
            
            if (brick.type === 'U') {
              disruptionBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "‚ûó",
                color: "#1E90FF",
                speed: 2
              });
            }
            
            if (brick.type === 'I') {
              playerBonuses.push({
                x: brick.x + brick.width/2,
                y: brick.y + brick.height/2,
                width: 15,
                height: 15,
                text: "‚ù§Ô∏è",
                color: "#C0C0C0",
                speed: 2
              });
            }
            
            if (megaBallActive || bigBallBonusActive) {
              if (megaBallActive) {
                createLightningEffect(brick.x + brick.width/2, brick.y + brick.height/2);
              }
              
              const reward = brick.reward * bonusMultiplier;
              score += reward;
              createRewardText(brick.x + brick.width/2, brick.y + brick.height/2, reward);
              createBrickBreakEffect(brick.x + brick.width/2, brick.y + brick.height/2, brick.color);
              bricks.splice(j, 1);
            } else {
              const ballCenterX = ball.x + ball.width/2;
              const ballCenterY = ball.y + ball.height/2;
              const brickCenterX = brick.x + brick.width/2;
              const brickCenterY = brick.y + brick.height/2;
              
              const dx = ballCenterX - brickCenterX;
              const dy = ballCenterY - brickCenterY;
              const width = (ball.width + brick.width) / 2;
              const height = (ball.height + brick.height) / 2;
              const crossWidth = width * dy;
              const crossHeight = height * dx;
              
              if (Math.abs(dx) <= width && Math.abs(dy) <= height) {
                if (crossWidth > crossHeight) {
                  ball.dy = -ball.dy;
                } else {
                  ball.dx = -ball.dx;
                }
              }
              
              const reward = brick.reward * bonusMultiplier;
              score += reward;
              
              createRewardText(brick.x + brick.width/2, brick.y + brick.height/2, reward);
              createBrickBreakEffect(brick.x + brick.width/2, brick.y + brick.height/2, brick.color);
              
              bricks.splice(j, 1);
            }
          }
        }
        
        if (bricksDestroyedThisHit >= 5) {
          comboCount = bricksDestroyedThisHit;
          activateComboEffect(comboCount);
        }
      }
      
      updateBonuses(bonuses, () => activateAgencyBonus());
      updateBonuses(decemberBonuses, () => createMultipleBalls());
      updateBonuses(lightningBonuses, () => activateMegaBall());
      updateBonuses(bigBallBonuses, () => activateBigBall());
      updateBonuses(twinBonuses, () => activateDuetBonus());
      updateBonuses(extendBonuses, () => activateExtendBonus());
      updateBonuses(laserBonuses, () => activateLaserBonus());
      updateBonuses(catchBonuses, () => activateCatchBonus());
      updateBonuses(slowBonuses, () => activateSlowBonus());
      updateBonuses(disruptionBonuses, () => activateDisruptionBonus());
      updateBonuses(playerBonuses, () => activatePlayerBonus());
      
      for (let i = lightningEffects.length - 1; i >= 0; i--) {
        const effect = lightningEffects[i];
        effect.life--;
        
        if (effect.life <= 0) {
          lightningEffects.splice(i, 1);
        }
      }
      
      updateRewardTexts();
      updateParticles();
      
      if (bricks.length === 0) {
        levelComplete();
      }
    }

    // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ–Ω—É—Å–æ–≤ (—É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è)
    function updateBonuses(bonusArray, activateCallback) {
      for (let i = bonusArray.length - 1; i >= 0; i--) {
        const bonus = bonusArray[i];
        bonus.y += bonus.speed;
        
        if (checkCollision(bonus, paddle) || (duetBonusActive && checkCollision(bonus, paddle2))) {
          activateCallback();
          bonusArray.splice(i, 1);
          updateStats();
        } else if (bonus.y > canvas.height) {
          bonusArray.splice(i, 1);
        }
      }
    }

    // –≠—Ñ—Ñ–µ–∫—Ç—ã —Ç–µ–∫—Å—Ç–∞ —Å –Ω–∞–≥—Ä–∞–¥–∞–º–∏
    function createRewardText(x, y, amount) {
      rewardTexts.push({
        x: x,
        y: y,
        text: '+' + amount.toLocaleString(),
        alpha: 1,
        life: 60
      });
    }
    
    function updateRewardTexts() {
      for (let i = rewardTexts.length - 1; i >= 0; i--) {
        const text = rewardTexts[i];
        text.y -= 1;
        text.alpha -= 1 / text.life;
        text.life--;
        
        if (text.life <= 0) {
          rewardTexts.splice(i, 1);
        }
      }
    }
    
    // –≠—Ñ—Ñ–µ–∫—Ç—ã —á–∞—Å—Ç–∏—Ü
    function createBrickBreakEffect(x, y, color) {
      for (let i = 0; i < 5; i++) {
        particles.push({
          x: x,
          y: y,
          dx: (Math.random() - 0.5) * 4,
          dy: (Math.random() - 0.5) * 4,
          size: Math.random() * 3 + 2,
          color: color,
          life: 30
        });
      }
    }
    
    function createHitEffect(x, y) {
      for (let i = 0; i < 3; i++) {
        particles.push({
          x: x,
          y: y,
          dx: (Math.random() - 0.5) * 3,
          dy: (Math.random() - 0.5) * 3,
          size: Math.random() * 2 + 1,
          color: '#ffd700',
          life: 20
        });
      }
    }
    
    function updateParticles() {
      for (let i = particles.length - 1; i >= 0; i--) {
        const p = particles[i];
        p.x += p.dx;
        p.y += p.dy;
        p.life--;
        
        if (p.life <= 0) {
          particles.splice(i, 1);
        }
      }
    }

    // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
    function render() {
      const shake = updateScreenShake();
      context.clearRect(shake.x, shake.y, canvas.width, canvas.height);
      context.save();
      context.translate(shake.x, shake.y);
      
      snowflakes.forEach(snowflake => {
        context.fillStyle = '#FFFFFF';
        context.font = `${snowflake.size}px Arial`;
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.globalAlpha = 0.7;
        context.fillText(snowflake.text, snowflake.x, snowflake.y);
        context.globalAlpha = 1;
      });
      
      comboSmileys.forEach(smiley => {
        context.fillStyle = '#FFD700';
        context.font = `${smiley.size}px Arial`;
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.globalAlpha = smiley.life / 60;
        context.fillText(smiley.text, smiley.x, smiley.y);
        context.globalAlpha = 1;
      });
      
      lasers.forEach(laser => {
        context.fillStyle = '#FF0000';
        context.fillRect(laser.x - laser.width/2, laser.y, laser.width, laser.height);
        
        context.strokeStyle = '#FF4500';
        context.lineWidth = 1;
        context.globalAlpha = 0.7;
        context.strokeRect(laser.x - laser.width/2 - 1, laser.y - 1, laser.width + 2, laser.height + 2);
        context.globalAlpha = 1;
      });
      
      context.fillStyle = 'rgba(255, 215, 0, 0.3)';
      context.fillRect(0, 0, canvas.width, wallSize);
      context.fillRect(0, 0, wallSize, canvas.height);
      context.fillRect(canvas.width - wallSize, 0, wallSize, canvas.height);
      
      bricks.forEach(brick => {
        context.fillStyle = brick.color;
        context.fillRect(brick.x, brick.y, brick.width, brick.height);
        
        context.fillStyle = brick.textColor;
        context.font = 'bold 8px Arial';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(brick.city, brick.x + brick.width/2, brick.y + brick.height/2);
      });
      
      drawBonuses(bonuses);
      drawSymbolBonuses(decemberBonuses, 15);
      drawSymbolBonuses(lightningBonuses, 15);
      drawSymbolBonuses(bigBallBonuses, 20);
      drawSymbolBonuses(twinBonuses, 15);
      drawSymbolBonuses(extendBonuses, 20);
      drawSymbolBonuses(laserBonuses, 15);
      drawSymbolBonuses(catchBonuses, 15);
      drawSymbolBonuses(slowBonuses, 15);
      drawSymbolBonuses(disruptionBonuses, 15);
      drawSymbolBonuses(playerBonuses, 15);
      
      lightningEffects.forEach(effect => {
        context.strokeStyle = '#FFFF00';
        context.lineWidth = 2;
        context.globalAlpha = effect.life / 10;
        
        effect.segments.forEach(segment => {
          context.beginPath();
          context.moveTo(segment.x1, segment.y1);
          context.lineTo(segment.x2, segment.y2);
          context.stroke();
        });
        
        context.globalAlpha = 1;
      });
      
      rewardTexts.forEach(text => {
        context.fillStyle = `rgba(255, 215, 0, ${text.alpha})`;
        context.font = 'bold 12px Arial';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(text.text, text.x, text.y);
      });
      
      particles.forEach(p => {
        context.fillStyle = p.color;
        context.globalAlpha = p.life / 30;
        context.beginPath();
        context.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        context.fill();
        context.globalAlpha = 1;
      });
      
      context.fillStyle = '#ffd700';
      context.fillRect(paddle.x, paddle.y, paddle.width, paddle.height);
      
      context.fillStyle = '#000000';
      context.font = 'bold 10px Arial';
      context.textAlign = 'center';
      context.textBaseline = 'middle';
      context.fillText('PERVUSHIN', paddle.x + paddle.width/2, paddle.y + paddle.height/2);
      
      if (duetBonusActive) {
        context.fillStyle = '#FF69B4';
        context.fillRect(paddle2.x, paddle2.y, paddle2.width, paddle2.height);
        
        context.fillStyle = '#000000';
        context.font = 'bold 8px Arial';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText('DUET', paddle2.x + paddle2.width/2, paddle2.y + paddle2.height/2);
      }
      
      balls.forEach(ball => {
        if (megaBallActive) {
          context.fillStyle = '#FFFF00';
          context.beginPath();
          context.arc(ball.x + ball.width/2, ball.y + ball.height/2, ball.width/2, 0, Math.PI * 2);
          context.fill();
          
          context.strokeStyle = '#FFFF00';
          context.lineWidth = 2;
          context.globalAlpha = 0.5;
          context.beginPath();
          context.arc(ball.x + ball.width/2, ball.y + ball.height/2, ball.width/2 + 3, 0, Math.PI * 2);
          context.stroke();
          context.globalAlpha = 1;
        } else if (bigBallBonusActive) {
          context.fillStyle = '#FF00FF';
          context.beginPath();
          context.arc(ball.x + ball.width/2, ball.y + ball.height/2, ball.width/2, 0, Math.PI * 2);
          context.fill();
          
          context.strokeStyle = '#FF00FF';
          context.lineWidth = 3;
          context.globalAlpha = 0.5;
          context.beginPath();
          context.arc(ball.x + ball.width/2, ball.y + ball.height/2, ball.width/2 + 4, 0, Math.PI * 2);
          context.stroke();
          context.globalAlpha = 1;
        } else {
          context.fillStyle = '#ffd700';
          context.beginPath();
          context.arc(ball.x + ball.width/2, ball.y + ball.height/2, ball.width/2, 0, Math.PI * 2);
          context.fill();
        }
      });
      
      context.restore();
    }

    // –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –±–æ–Ω—É—Å–æ–≤
    function drawBonuses(bonusArray) {
      bonusArray.forEach(bonus => {
        context.fillStyle = bonus.color;
        context.fillRect(bonus.x, bonus.y, bonus.width, bonus.height);
        
        context.fillStyle = '#000000';
        context.font = 'bold 7px Arial';
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(bonus.text, bonus.x + bonus.width/2, bonus.y + bonus.height/2);
      });
    }

    function drawSymbolBonuses(bonusArray, fontSize) {
      bonusArray.forEach(bonus => {
        context.fillStyle = bonus.color;
        context.font = `bold ${fontSize}px Arial`;
        context.textAlign = 'center';
        context.textBaseline = 'middle';
        context.fillText(bonus.text, bonus.x, bonus.y);
      });
    }

    // –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è
    function levelComplete() {
      gameRunning = false;
      document.getElementById('totalScore').textContent = score.toLocaleString();
      finalScreen.style.display = 'block';
    }

    // –ö–æ–Ω–µ—Ü –∏–≥—Ä—ã
    function gameOver() {
      gameRunning = false;
      document.getElementById('finalScore').textContent = score.toLocaleString();
      gameOverScreen.style.display = 'block';
    }

    // –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –≤ —Ñ–∏–Ω–∞–ª—å–Ω–æ–º —ç–∫—Ä–∞–Ω–µ
    finalRestartBtn.addEventListener('click', () => {
      score = 0;
      level = 1;
      lives = 3;
      bonusActive = false;
      bonusMultiplier = 1;
      decemberBonusActive = false;
      lightningBonusActive = false;
      megaBallActive = false;
      bigBallBonusActive = false;
      snowEffectActive = false;
      snowflakes = [];
      comboSmileys = [];
      comboCount = 0;
      screenShake = 0;
      duetBonusActive = false;
      extendBonusActive = false;
      laserBonusActive = false;
      catchBonusActive = false;
      slowBonusActive = false;
      disruptionBonusActive = false;
      playerBonusActive = false;
      lasers = [];
      countdown = 5;
      finalScreen.style.display = 'none';
      gameOverScreen.style.display = 'none';
      countdownElement.style.display = 'flex';
      countdownElement.textContent = countdown;
      createLevel();
      resetBall();
      updateStats();
      startCountdown();
    });

    // –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
    document.getElementById('restartBtn').addEventListener('click', () => {
      score = 0;
      level = 1;
      lives = 3;
      bonusActive = false;
      bonusMultiplier = 1;
      decemberBonusActive = false;
      lightningBonusActive = false;
      megaBallActive = false;
      bigBallBonusActive = false;
      snowEffectActive = false;
      snowflakes = [];
      comboSmileys = [];
      comboCount = 0;
      screenShake = 0;
      duetBonusActive = false;
      extendBonusActive = false;
      laserBonusActive = false;
      catchBonusActive = false;
      slowBonusActive = false;
      disruptionBonusActive = false;
      playerBonusActive = false;
      lasers = [];
      countdown = 5;
      gameOverScreen.style.display = 'none';
      finalScreen.style.display = 'none';
      countdownElement.style.display = 'flex';
      countdownElement.textContent = countdown;
      createLevel();
      resetBall();
      updateStats();
      startCountdown();
    });

    // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞
    function resizeCanvas() {
      const container = canvas.parentElement;
      const containerWidth = container.clientWidth;
      const aspectRatio = 400 / 500;
      
      canvas.width = containerWidth;
      canvas.height = containerWidth / aspectRatio;
      
      paddle.y = canvas.height - 30;
      paddle.x = (canvas.width - paddle.width) / 2;
      
      resetBall();
    }

    window.addEventListener('resize', resizeCanvas);

    // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–≥—Ä—É
    initGame();
  </script>
</body>
</html>
